
<%= render 'layouts/flash' %>
<% if !@product.categories.empty? %>
    <p><%= link_to @product.categories.first.name, products_path(:category => { :category1 => @product.categories.first.name }) %>  >  
       <%= link_to @product.categories.second.name, products_path(:category => { :category2 => @product.categories.first.name }) %>  >  
       <%= link_to @product.categories.third.name, products_path(:category => { :category3 => @product.categories.first.name }) %>  >  
       <%= @product.name %>
  <% end %>
<section id="left">
  <%= place_image(@product) %>
</section>  
<section id="right">
<article class="product">      
    <header>
      <h2><%= @product.name %></h2>
    </header>
    <table> 
    <tr> 
      <p>
        <%= simple_format(word_wrap(@product.description, line_width: 30)) %>
      </p>
    </tr>
    <tr>  
      <h3>Price</h3>
      <p><%= format_price(@product) %></p>
    </tr> 
    <% if admin_user? %>
      <tr>
        <h3>Quantity: </h3>
        <p><%= @product.quantity %></p>
      </tr>  
    <% else %> 
        <tr>
         <p><%= display_add_button(@product).html_safe %></p> 
        </tr> 
    <% end %> 
      <p>
        <%= link_to pluralize(@product.reviews.size, 'Review'), product_reviews_url(@product), class: 'button_review' %>
        <%= link_to 'Write review', new_product_review_path(@product), class: 'button_review' %>   
      </p>  
      <% if admin_user? %>
      <div id="prod_links">
        <%= link_to "Edit product", edit_product_path(@product) %> |
        <%= link_to 'Delete product', product_path(@product), method: :delete, data: { confirm: 'Are you sure you want to delete this product?' } %> |
        <%= link_to 'Cancel', products_path %>
      </div>
      <% end %>     
  <% if admin_user? %>
    <h2><%= pluralize(@customers.size, 'customer') %> added this product to their wishlist.</h2>
    <% @customers.each do |customer| %>
      <li><%= link_to customer.name, user_path(customer) %></li>
    <% end %>
  <% end %>  
</table>
<% if @user_wishlist %>
         <tr>
           <p><%= button_to 'Remove from wishlist', product_wishlist_path(@product, @user_wishlist.id), method: :delete, class: 'wish-button'%></p>
         </tr>  
       <% else %>
          <tr>
            <p><%= button_to 'Add to wishlist', product_wishlists_path(@product), class: 'button' %></p>
          </tr>  
       <% end %> 
  <%= link_to 'Return', products_path,  class: 'button' %>
</article>
</section>